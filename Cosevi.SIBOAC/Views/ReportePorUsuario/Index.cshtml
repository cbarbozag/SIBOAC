@model Cosevi.SIBOAC.Models.ParteOficial

@{
    ViewBag.Title = "ReportePorUsuario";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Reporte por Usuario - Estatus Plano o Croquis</h2>
<br>
<br>
<br>
<br>
@using (Html.BeginForm("Index", "ReportePorUsuario", FormMethod.Get))
{

    <table>
        <tr>
            <th>
                @Html.Label("Fecha de Inicio", htmlAttributes: new { @class = "control-label col-md-2" })
            </th>
            <td>
                @Html.EditorFor(model => model.Fecha)
                @Html.ValidationMessageFor(model => model.Fecha, "", new { @class = "text-danger" })
            </td>
            <td>
                @Html.Label("Fecha de Finalización", htmlAttributes: new { @class = "control-label col-md-2" })
            </td>
            <td>
                @Html.EditorFor(model => model.Fecha)
                @Html.ValidationMessageFor(model => model.Fecha, "", new { @class = "text-danger" })
            </td>
            <td>
                <input type="submit" value="Generar Reporte" class="btn btn-success" />
            </td>
        </tr>
    </table>

    <td>
        @Html.ListBoxFor(model => model.SelectedItemId, new MultiSelectList(Model.usuario, "Value", "Text"), new { @id = "lstEmail" })
    </td>
}
<br />
<br />

@if (ViewBag.Valor != null)
{
    TempData["Type"] = null;
    TempData["Message"] = null;


    using (Html.BeginForm("Exportar", "ReportePorUsuario", FormMethod.Get))
    {
        <div class="panel panel-success">
            <div class="panel-heading">
                <input input type="image" name="Excel" value="Excel" src="~/Content/btnExcel.png" onclick="document.getElementsByName('Excel').submit();" />
                <input input type="image" name="PDF" value="PDF" src="~/Content/btnPDF.png" />
            </div>
            <div class="panel-body">
                @Html.Partial("_MostrarReporteView", Model)
            </div>
        </div>
    }

}

